{% extends 'index.html' %}
{% block content %}
<style>
.document-list { background: white; border-radius: 8px; padding: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
.search-bar { display: flex; gap: 10px; margin-bottom: 20px; }
.search-bar input { flex: 1; padding: 8px 12px; border-radius: 6px; border: 1px solid #ccc; }
.search-bar button { padding: 8px 16px; background: #b71c1c; color: white; border: none; border-radius: 6px; cursor: pointer; }
.table { width: 100%; border-collapse: collapse; margin-top: 15px; }
.table th, .table td { padding: 12px; text-align: left; border-bottom: 1px solid #eee; font-size: 14px; }
.table th { background: #f1f3f5; font-weight: 600; text-transform: uppercase; }
.status-badge { display: inline-block; padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: 600; }
.status-closed { background: #e2e3e5; color: #383d41; border: 1px solid #e2e3e5; }
.action-btns { display: flex; gap: 5px; }
.action-btns a { padding: 4px 8px; font-size: 12px; border: none; border-radius: 4px; cursor: pointer; text-decoration: none; background: #6c757d; color: white; }
.btn-small { padding: 4px 8px; font-size: 12px; }
</style>

<div class="content">
  <h1 class="dashboard-title">Archived / Closed Documents</h1>
  <p>Archive of closed and completed documents from {{ current_user.department }}.</p>

  <div class="search-bar">
    <input type="text" id="searchInput" placeholder="Search by document ID or title..." />
    <button onclick="filterTable()">Search</button>
  </div>

  <div class="document-list">
    <table class="table" id="docTable">
      <thead>
        <tr>
          <th>Document ID</th>
          <th>Title</th>
          <th>Type</th>
          <th>Department</th>
          <th>Amount</th>
          <th>Closed Date</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody>
        {% for r in records %}
        <tr data-doc-id="{{ r.id }}" data-search="{{ r.document_id|lower }} {{ r.title|lower }}">
          <td><strong>{{ r.document_id }}</strong></td>
          <td>{{ r.title }}</td>
          <td>{{ r.doc_type }}</td>
          <td>{{ r.department }}</td>
          <td>{{ "â‚± %.2f"|format(r.amount) if r.amount else "-" }}</td>
          <td>{{ r.updated_at.strftime('%Y-%m-%d') if r.updated_at else '-' }}</td>
          <td>
            <a href="{{ url_for('main.document_detail', record_id=r.id) }}" class="btn-small">View Details</a>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    {% if not records %}
    <p style="text-align:center;color:#999;margin-top:20px;">No archived documents.</p>
    {% endif %}
  </div>
</div>

<script>
function filterTable() {
  const search = document.getElementById('searchInput').value.toLowerCase();
  const rows = document.querySelectorAll('#docTable tbody tr');
  rows.forEach(row => {
    const text = row.dataset.search || '';
    row.style.display = text.includes(search) ? '' : 'none';
  });
}
</script>

{% endblock %}

